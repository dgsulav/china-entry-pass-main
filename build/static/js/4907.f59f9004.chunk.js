"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4907],{29801:function(e,r,s){s.d(r,{Mn:function(){return n},My:function(){return a},W2:function(){return o}});var t=s(30577);t.Am.configure();var n=function(e){var r="string"===typeof e?e:"error";t.Am.error(r,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},a=function(e){var r="string"===typeof e?e:"success";t.Am.success(r,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},o=function(e){var r="string"===typeof e?e:"success";t.Am.info(r,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},94924:function(e,r,s){s.d(r,{Z:function(){return n}});s(72791);var t=s(80184),n=function(e){return(0,t.jsx)("div",{className:"error",children:e.children})}},34907:function(e,r,s){s.r(r);var t=s(70885),n=s(72791),a=s(65804),o=s(94924),c=s(16030),i=s(92506),u=s(76863),d=(s(7623),s(28931)),l=s(52685),p=s(80184);r.default=function(){(0,c.v9)((function(e){return e.auth.userid}));var e=(0,c.I0)(),r=(0,d.k6)(),s=(0,n.useState)("password"),f=(0,t.Z)(s,2),h=f[0],m=f[1],v=(0,n.useState)("password"),w=(0,t.Z)(v,2),x=w[0],y=w[1],g=(0,n.useState)("password"),S=(0,t.Z)(g,2),N=S[0],j=S[1],b=u.Ry().shape({old_password:u.Z_().required("Old Password  is required"),password:u.Z_().required("Please Enter your password").matches(/^(?=.*[a-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{6,}$/,"Must Contain 6 Characters, One alphabet and One Number "),confirm_password:u.Z_().required("Password is required").oneOf([u.iH("password"),null],"Passwords must match")}),C=function(){m("password"===h?"text":"password")},_=function(){y("password"===x?"text":"password")},k=function(){j("password"===N?"text":"password")};return(0,p.jsx)("div",{className:"",children:(0,p.jsx)("div",{className:"account-pages my-5",children:(0,p.jsx)("div",{className:"container",children:(0,p.jsx)("div",{className:"row justify-content-center ",children:(0,p.jsx)("div",{className:"col-md-8 col-lg-6 col-xl-5",children:(0,p.jsxs)("div",{className:"card overflow-hidden card-reset",children:[(0,p.jsx)("div",{className:"bg-primary bg-soft",children:(0,p.jsx)("div",{className:"row",children:(0,p.jsx)("div",{className:"col-sm-12",children:(0,p.jsx)("div",{className:"text-center m-3",children:(0,p.jsx)("h5",{children:"Change password"})})})})}),(0,p.jsx)("div",{className:"card-body pt-0",children:(0,p.jsx)("div",{className:"w-100",children:(0,p.jsx)(i.J9,{initialValues:{password:"",confirm_password:"",old_password:""},validationSchema:b,onSubmit:function(s){var t=s.password,n=s.confirm_password,a=s.old_password;e((0,l.Cp)(a,t,n,r))},children:function(e){return(0,p.jsxs)(i.l0,{autoComplete:"off",className:"form-horizontal ",children:[(0,p.jsxs)("div",{className:"mb-3   password-field",children:[(0,p.jsx)("label",{htmlFor:"old_password",className:"form-label ",children:"Old Password"}),(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)(i.gN,{type:h,className:"form-control change-textfield ",name:"old_password",placeholder:"Old Password"}),(0,p.jsx)("span",{onClick:C,children:"password"===h?(0,p.jsx)(a.cqT,{}):(0,p.jsx)(a.rnh,{})})]}),(0,p.jsx)(i.Bc,{name:"old_password",component:o.Z})]}),(0,p.jsxs)("div",{className:"mb-3  password-field",children:[(0,p.jsx)("label",{htmlFor:"password",className:"form-label ",children:"New Password"}),(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)(i.gN,{type:N,className:"form-control change-textfield ",name:"password",placeholder:"New Password"}),(0,p.jsx)("span",{onClick:k,children:"password"===N?(0,p.jsx)(a.cqT,{}):(0,p.jsx)(a.rnh,{})})]}),(0,p.jsx)(i.Bc,{name:"password",component:o.Z})]}),(0,p.jsxs)("div",{className:"mb-3  password-field",children:[(0,p.jsx)("label",{htmlFor:"confirm-password",className:"form-label ",children:"Confirm Password"}),(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)(i.gN,{type:x,className:"form-control change-textfield ",name:"confirm_password",placeholder:"Confirm Password"}),(0,p.jsx)("span",{onClick:_,children:"password"===x?(0,p.jsx)(a.cqT,{}):(0,p.jsx)(a.rnh,{})})]}),(0,p.jsx)(i.Bc,{name:"confirm_password",component:o.Z})]}),(0,p.jsx)("div",{className:"mt-3 d-grid text-center",children:(0,p.jsx)("button",{className:"btn btn-primary waves-effect waves-light mt-4 m-3",type:"submit",children:"Save Changes"})})]})}})})})]})})})})})})}},52685:function(e,r,s){s.d(r,{Cp:function(){return S},Zb:function(){return g},x4:function(){return x},c0:function(){return y},tb:function(){return N}});var t=s(15861),n=s(64687),a=s.n(n),o=s(89731),c=function(e){return o.ZP.post("auth/login",e)},i=function(e){return o.ZP.post("api/v1/user-app/password-reset/",e)},u=function(e){return o.ZP.post("api/v1/user-app/password-reset/confirm/",e)},d=function(e){return o.ZP.patch("auth/change-password",e)},l=function(e){return o.ZP.patch("auth/update-signature",e)},p=s(48044),f=function(){return{type:p.w.LOADING}},h=function(e){return{type:p.w.LOGIN_SUCCESS,payload:e}},m=function(e){return{type:p.w.RESET_SUCCESS,payload:e}},v=function(e){return{type:p.w.PASSWORD_CHANGE_SUCCESS,payload:e}},w=s(29801),x=function(e,r){return function(){var s=(0,t.Z)(a().mark((function s(t){var n,o,i;return a().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,t(f()),n={username:e,password:r},s.next=5,c(n);case 5:o=s.sent,i=o.data,(0,w.My)("Welcome ".concat(i.user.username)),t(h(i)),s.next=16;break;case 11:s.prev=11,s.t0=s.catch(0),console.log(s.t0,"error"),(0,w.Mn)(s.t0),t((a=s.t0,{type:p.w.LOGIN_FAIL,payload:a}));case 16:case"end":return s.stop()}var a}),s,null,[[0,11]])})));return function(e){return s.apply(this,arguments)}}()},y=function(e){return function(){var r=(0,t.Z)(a().mark((function r(s){var t,n,o;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,s({type:p.w.LOADING_RESET_PASSWORD}),t=JSON.stringify({email:e}),r.next=5,i(t);case 5:n=r.sent,o=n.data,s(m(o)),(0,w.My)("Email send successfully "),r.next=15;break;case 11:r.prev=11,r.t0=r.catch(0),s((a=r.t0,{type:p.w.RESET_FAIL,payload:a})),(0,w.Mn)("There is no active user associated with this e-mail address  || the password can not be changed ");case 15:case"end":return r.stop()}var a}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}()},g=function(e,r,s,n){return function(){var o=(0,t.Z)(a().mark((function t(o){var c,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o({type:p.w.LOADING_RESET}),c=JSON.stringify({token:s,password:e,confirm_password:r}),t.next=5,u(c);case 5:i=t.sent,i.data,o({type:p.w.PASSWORD_CONFIRM_SUCCESS}),(0,w.My)("Password has been reset successfully "),o({type:p.w.RESET_SUCCESS,payload:[]}),n.push("/"),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),o((a=t.t0,{type:p.w.PASSWORD_CONFIRM_FAIL,payload:a})),(0,w.Mn)("Failed to reset Password");case 17:case"end":return t.stop()}var a}),t,null,[[0,13]])})));return function(e){return o.apply(this,arguments)}}()},S=function(e,r,s,n){return function(){var o=(0,t.Z)(a().mark((function t(o){var c,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o(f()),c=JSON.stringify({password:r,old_password:e,confirm_password:s}),t.next=5,d(c);case 5:i=t.sent,o(v(i)),(0,w.My)("Password changed successfully "),n.push("/"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),o((a=t.t0,{type:p.w.PASSWORD_CHANGE_FAIL,payload:a})),(0,w.Mn)(t.t0);case 15:case"end":return t.stop()}var a}),t,null,[[0,11]])})));return function(e){return o.apply(this,arguments)}}()},N=function(e){return function(){var r=(0,t.Z)(a().mark((function r(s){var t,n;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,s(f()),t=JSON.stringify({signature:e,signatureUpdating:!0}),r.next=5,l(t);case 5:return n=r.sent,(0,w.My)("Signature updated successfully"),s((o=null===n||void 0===n?void 0:n.data,{type:p.w.UPDATE_SIGNATURE_SUCCESS,payload:o})),r.abrupt("return",!0);case 11:r.prev=11,r.t0=r.catch(0),s((a=r.t0,{type:p.w.UPDATE_SIGNATURE_FAIL,payload:a})),(0,w.Mn)(r.t0);case 15:case"end":return r.stop()}var a,o}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}()}},89731:function(e,r,s){s.d(r,{Yb:function(){return l}});var t=s(15861),n=s(64687),a=s.n(n),o=s(74569),c=s.n(o),i=s(90106),u=s(48044),d=s(30577),l=(c().create({baseURL:"http://chinapass.sushiloli.com.np"}),c().create({baseURL:"http://localhost:9010",headers:{"Content-Type":"application/json"}})),p=c().create({baseURL:"http://chinapass.sushiloli.com.np",headers:{"Content-Type":"application/json"}});p.interceptors.request.use((function(e){if(window.navigator.onLine)return e.headers.Authorization=localStorage.getItem("accessToken")?"Bearer ".concat(localStorage.getItem("accessToken")):null,e.baseURL="http://chinapass.sushiloli.com.np",e}),(function(e){return Promise.reject(e)})),p.interceptors.response.use((function(e){return e}),function(){var e=(0,t.Z)(a().mark((function e(r){var s,t,n,o,c,l,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.config,401===r.response.status&&"auth/token/refresh"===c.url&&i.h.dispatch({type:u.w.AUTH_ERROR}),"token_not_valid"!==(null===(s=r.response)||void 0===s?void 0:s.data.code)||c._retry){e.next=19;break}return c._retry=!0,e.prev=4,l=JSON.stringify({refresh:localStorage.getItem("refreshToken")}),localStorage.removeItem("accessToken"),e.next=9,p.post("auth/token/refresh",l);case 9:if(200!==(f=e.sent).status){e.next=14;break}return localStorage.setItem("accessToken",null===f||void 0===f?void 0:f.data.access),c.headers.Authorization="Bearer ".concat(null===f||void 0===f?void 0:f.data.access),e.abrupt("return",p(c));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),i.h.dispatch({type:u.w.AUTH_ERROR});case 19:if("No Internet"===r&&d.Am.error("No Internet Connection !!!"),"Network Error"===r.message&&d.Am.error("Internal Server Error. Contact IT manager !!!",{autoClose:1200}),500===(null===(t=r.response)||void 0===t?void 0:t.status)&&d.Am.error("Internal Server Error. Contact IT manager !!!",{autoClose:1200}),404===(null===(n=r.response)||void 0===n?void 0:n.status)&&d.Am.error("Page Not Found !!!!!",{autoClose:1200}),401!==(null===(o=r.response)||void 0===o?void 0:o.status)&&"Invalid token specified"!==r.message){e.next=26;break}return i.h.dispatch({type:u.w.AUTH_ERROR}),e.abrupt("return",Promise.reject(r.response.data.detail));case 26:if(!(r.response&&r.response.status>=400&&r.response.status<500)){e.next=33;break}if(!r.response.data.detail){e.next=32;break}return e.abrupt("return",Promise.reject("".concat(r.response.data.detail)));case 32:return e.abrupt("return",Promise.reject("".concat(r.response.statusText)));case 33:return e.abrupt("return",Promise.reject(r));case 34:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(r){return e.apply(this,arguments)}}()),r.ZP=p},7623:function(){}}]);
//# sourceMappingURL=4907.f59f9004.chunk.js.map