"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6497],{29801:function(e,t,r){r.d(t,{Mn:function(){return a},My:function(){return s},W2:function(){return o}});var n=r(30577);n.Am.configure();var a=function(e){var t="string"===typeof e?e:"error";n.Am.error(t,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},s=function(e){var t="string"===typeof e?e:"success";n.Am.success(t,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},o=function(e){var t="string"===typeof e?e:"success";n.Am.info(t,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},6497:function(e,t,r){r.r(t),r.d(t,{default:function(){return v}});var n=r(15861),a=r(70885),s=r(64687),o=r.n(s),c=r(72791),u=r(4847),i=r(28931),p=r(16030),l=r(52685),d=r(29801),f=r(80184),v=function(){var e=(0,i.k6)(),t=(0,p.I0)(),r=(0,c.useState)([""]),s=(0,a.Z)(r,2),v=s[0],h=s[1],g=(0,c.useState)([""]),m=(0,a.Z)(g,2),y=m[0],w=m[1],S=(0,p.v9)((function(e){return e.auth.signaturePhoto}));console.log(S,"sig");var b=function(){var e=(0,n.Z)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=null===v||void 0===v?void 0:v.map((function(e,r){return r===t?"":e})),n=null===y||void 0===y?void 0:y.map((function(e,r){return r===t?"":e})),h(r),w(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var r=(0,n.Z)(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(""===v[0]){r.next=7;break}return r.next=3,t((0,l.tb)(v[0]));case 3:r.sent&&e.push("/"),r.next=8;break;case 7:(0,d.Mn)("Please capture the signature first.");case 8:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return(0,c.useEffect)((function(){window.startSignatureService()}),[]),(0,f.jsxs)("div",{className:"signature-wrapper card p-5",children:[(0,f.jsx)("h3",{className:"text-center",children:"Update Signature"}),(0,f.jsx)("div",{className:"signature-container",children:""===v[0]?(0,f.jsx)("div",{className:"signature-card card",children:S?(0,f.jsx)("img",{src:S,alt:"default-signature"}):(0,f.jsx)("img",{src:u,alt:"default-signature"})}):(0,f.jsx)("div",{className:"signature-card card",children:(0,f.jsx)("img",{src:v[0],alt:"signature"})})}),(0,f.jsxs)("div",{className:"d-flex justify-content-center align-items-center gap-2 my-1",children:[(0,f.jsx)("button",{type:"button",className:"btn btn-sm btn-primary mr-2",onClick:function(){return function(e){var t;null===(t=window)||void 0===t||t.captureSignature(v,h,y,w,e)}(0)},disabled:""!==v[0],children:"Capture"}),(0,f.jsx)("button",{type:"button",className:"btn btn-sm btn-danger mr-2",onClick:function(){return b(0)},disabled:""===v[0],children:"Clear"}),(0,f.jsx)("button",{type:"button",className:"btn btn-sm btn-success",onClick:x,disabled:""===v[0],children:"Save"})]})]})}},52685:function(e,t,r){r.d(t,{Cp:function(){return b},Zb:function(){return S},x4:function(){return y},c0:function(){return w},tb:function(){return x}});var n=r(15861),a=r(64687),s=r.n(a),o=r(89731),c=function(e){return o.ZP.post("auth/login",e)},u=function(e){return o.ZP.post("api/v1/user-app/password-reset/",e)},i=function(e){return o.ZP.post("api/v1/user-app/password-reset/confirm/",e)},p=function(e){return o.ZP.patch("auth/change-password",e)},l=function(e){return o.ZP.patch("auth/update-signature",e)},d=r(48044),f=function(){return{type:d.w.LOADING}},v=function(e){return{type:d.w.LOGIN_SUCCESS,payload:e}},h=function(e){return{type:d.w.RESET_SUCCESS,payload:e}},g=function(e){return{type:d.w.PASSWORD_CHANGE_SUCCESS,payload:e}},m=r(29801),y=function(e,t){return function(){var r=(0,n.Z)(s().mark((function r(n){var a,o,u;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n(f()),a={username:e,password:t},r.next=5,c(a);case 5:o=r.sent,u=o.data,(0,m.My)("Welcome ".concat(u.user.username)),n(v(u)),r.next=16;break;case 11:r.prev=11,r.t0=r.catch(0),console.log(r.t0,"error"),(0,m.Mn)(r.t0),n((s=r.t0,{type:d.w.LOGIN_FAIL,payload:s}));case 16:case"end":return r.stop()}var s}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}()},w=function(e){return function(){var t=(0,n.Z)(s().mark((function t(r){var n,a,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r({type:d.w.LOADING_RESET_PASSWORD}),n=JSON.stringify({email:e}),t.next=5,u(n);case 5:a=t.sent,o=a.data,r(h(o)),(0,m.My)("Email send successfully "),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),r((s=t.t0,{type:d.w.RESET_FAIL,payload:s})),(0,m.Mn)("There is no active user associated with this e-mail address  || the password can not be changed ");case 15:case"end":return t.stop()}var s}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},S=function(e,t,r,a){return function(){var o=(0,n.Z)(s().mark((function n(o){var c,u;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o({type:d.w.LOADING_RESET}),c=JSON.stringify({token:r,password:e,confirm_password:t}),n.next=5,i(c);case 5:u=n.sent,u.data,o({type:d.w.PASSWORD_CONFIRM_SUCCESS}),(0,m.My)("Password has been reset successfully "),o({type:d.w.RESET_SUCCESS,payload:[]}),a.push("/"),n.next=17;break;case 13:n.prev=13,n.t0=n.catch(0),o((s=n.t0,{type:d.w.PASSWORD_CONFIRM_FAIL,payload:s})),(0,m.Mn)("Failed to reset Password");case 17:case"end":return n.stop()}var s}),n,null,[[0,13]])})));return function(e){return o.apply(this,arguments)}}()},b=function(e,t,r,a){return function(){var o=(0,n.Z)(s().mark((function n(o){var c,u;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o(f()),c=JSON.stringify({password:t,old_password:e,confirm_password:r}),n.next=5,p(c);case 5:u=n.sent,o(g(u)),(0,m.My)("Password changed successfully "),a.push("/"),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),o((s=n.t0,{type:d.w.PASSWORD_CHANGE_FAIL,payload:s})),(0,m.Mn)(n.t0);case 15:case"end":return n.stop()}var s}),n,null,[[0,11]])})));return function(e){return o.apply(this,arguments)}}()},x=function(e){return function(){var t=(0,n.Z)(s().mark((function t(r){var n,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r(f()),n=JSON.stringify({signature:e,signatureUpdating:!0}),t.next=5,l(n);case 5:return a=t.sent,(0,m.My)("Signature updated successfully"),r((o=null===a||void 0===a?void 0:a.data,{type:d.w.UPDATE_SIGNATURE_SUCCESS,payload:o})),t.abrupt("return",!0);case 11:t.prev=11,t.t0=t.catch(0),r((s=t.t0,{type:d.w.UPDATE_SIGNATURE_FAIL,payload:s})),(0,m.Mn)(t.t0);case 15:case"end":return t.stop()}var s,o}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()}},89731:function(e,t,r){r.d(t,{Yb:function(){return l}});var n=r(15861),a=r(64687),s=r.n(a),o=r(74569),c=r.n(o),u=r(90106),i=r(48044),p=r(30577),l=(c().create({baseURL:"http://chinapass.sushiloli.com.np"}),c().create({baseURL:"http://localhost:9010",headers:{"Content-Type":"application/json"}})),d=c().create({baseURL:"http://chinapass.sushiloli.com.np",headers:{"Content-Type":"application/json"}});d.interceptors.request.use((function(e){if(window.navigator.onLine)return e.headers.Authorization=localStorage.getItem("accessToken")?"Bearer ".concat(localStorage.getItem("accessToken")):null,e.baseURL="http://chinapass.sushiloli.com.np",e}),(function(e){return Promise.reject(e)})),d.interceptors.response.use((function(e){return e}),function(){var e=(0,n.Z)(s().mark((function e(t){var r,n,a,o,c,l,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.config,401===t.response.status&&"auth/token/refresh"===c.url&&u.h.dispatch({type:i.w.AUTH_ERROR}),"token_not_valid"!==(null===(r=t.response)||void 0===r?void 0:r.data.code)||c._retry){e.next=19;break}return c._retry=!0,e.prev=4,l=JSON.stringify({refresh:localStorage.getItem("refreshToken")}),localStorage.removeItem("accessToken"),e.next=9,d.post("auth/token/refresh",l);case 9:if(200!==(f=e.sent).status){e.next=14;break}return localStorage.setItem("accessToken",null===f||void 0===f?void 0:f.data.access),c.headers.Authorization="Bearer ".concat(null===f||void 0===f?void 0:f.data.access),e.abrupt("return",d(c));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),u.h.dispatch({type:i.w.AUTH_ERROR});case 19:if("No Internet"===t&&p.Am.error("No Internet Connection !!!"),"Network Error"===t.message&&p.Am.error("Internal Server Error. Contact IT manager !!!",{autoClose:1200}),500===(null===(n=t.response)||void 0===n?void 0:n.status)&&p.Am.error("Internal Server Error. Contact IT manager !!!",{autoClose:1200}),404===(null===(a=t.response)||void 0===a?void 0:a.status)&&p.Am.error("Page Not Found !!!!!",{autoClose:1200}),401!==(null===(o=t.response)||void 0===o?void 0:o.status)&&"Invalid token specified"!==t.message){e.next=26;break}return u.h.dispatch({type:i.w.AUTH_ERROR}),e.abrupt("return",Promise.reject(t.response.data.detail));case 26:if(!(t.response&&t.response.status>=400&&t.response.status<500)){e.next=33;break}if(!t.response.data.detail){e.next=32;break}return e.abrupt("return",Promise.reject("".concat(t.response.data.detail)));case 32:return e.abrupt("return",Promise.reject("".concat(t.response.statusText)));case 33:return e.abrupt("return",Promise.reject(t));case 34:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(t){return e.apply(this,arguments)}}()),t.ZP=d},4847:function(e,t,r){e.exports=r.p+"static/media/signature.de22341ec30f234cffcd.gif"}}]);
//# sourceMappingURL=6497.a0bf4ee6.chunk.js.map