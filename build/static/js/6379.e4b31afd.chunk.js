"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6379],{25922:function(e,t,n){n.d(t,{EQ:function(){return a},ir:function(){return i},mt:function(){return c},od:function(){return r}});var i=[{id:"immigration",name:"Immigration Office"},{id:"dao",name:"District Administration Office"}],r=[{id:"m",name:"Male"},{id:"f",name:"Female"},{id:"o",name:"Other"}],a=[{id:"pending",name:"PENDING"},{id:"verified",name:"VERIFIED"},{id:"rejected",name:"REJECTED"},{id:"approved",name:"APPROVED"},{id:"printed",name:"PRINTED"}],c=[{id:"pending",name:"PENDING"},{id:"approved",name:"APPROVED"},{id:"printed",name:"PRINTED"}]},42093:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var i=n(70885),r=n(72791),a=n(50645),c=n(15861),s=n(64687),o=n.n(s),l=n(89731),u="api/v1/core-app/office-setup/list",d=function(e){return l.ZP.get("".concat(u,"?offset=0&limit=").concat(e,"&ordering=-id"))},f=function(e){return l.ZP.get(e)},p=function(e){return l.ZP.get(e)},v=function(e,t){return l.ZP.get("".concat(u,"?offset=").concat((e-1)*t,"&limit=").concat(t,"&ordering=-id"))},m=function(e){return l.ZP.post("api/v1/core-app/office-setup",e)},h=function(e,t){return l.ZP.patch("api/v1/core-app/office-setup/".concat(e),t)},x=function(e,t){return l.ZP.get("".concat(u,"?offset=0&limit=").concat(t,"&search=").concat(e))},b=n(74927),g=function(){return{type:b.R.LOADING_OFFICE}},j=function(e){return{type:b.R.GET_OFFICE_SUCCESS,payload:e}},N=function(e){return{type:b.R.GET_OFFICE_FAIL,payload:e}},y=n(29801),P=function(e){return function(){var t=(0,c.Z)(o().mark((function t(n){var i,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(g()),t.next=4,d(e);case 4:i=t.sent,r=i.data,n(j(r)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),n(N(t.t0)),(0,y.Mn)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},w=function(e){var t=e.number,n=e.postsPerPage;return function(){var e=(0,c.Z)(o().mark((function e(i){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(g()),e.next=4,v(t,n);case 4:r=e.sent,a=r.data,i(j(a)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),i(N(e.t0)),(0,y.Mn)(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},k=function(e,t,n){return function(){var i=(0,c.Z)(o().mark((function i(r){var a,c,s,l,u,d,f;return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=e.officeType,c=e.palika,s=e.province,l=e.district,u=e.ward,d=e.isActive,i.prev=1,r(g()),f=JSON.stringify({officeType:a,palika:c,province:s,district:l,ward:u,isActive:d}),i.next=6,m(f);case 6:return r(w({number:t,postsPerPage:n})),(0,y.My)("Office created successfully "),i.abrupt("return",!0);case 11:i.prev=11,i.t0=i.catch(1),r((o=i.t0,{type:b.R.CREATE_OFFICE_FAIL,payload:o})),(0,y.Mn)(i.t0.message);case 15:case"end":return i.stop()}var o}),i,null,[[1,11]])})));return function(e){return i.apply(this,arguments)}}()},Z=function(e){return function(){var t=(0,c.Z)(o().mark((function t(n){var i,r,a,c,s,l,u,d,f,p,v;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.id,r=e.values,a=e.currentPage,c=r.officeType,s=r.palika,l=r.province,u=r.district,d=r.ward,f=r.isActive,t.prev=2,n({type:b.R.LOADING_UPDATED}),p=JSON.stringify({officeType:c,palika:s,province:l,district:u,ward:d,isActive:f}),n(g()),t.next=8,h(i,p);case 8:return v=t.sent,v.data,n(w({number:a,postsPerPage:10})),(0,y.My)("Office Updated Successfully "),t.abrupt("return",!0);case 15:t.prev=15,t.t0=t.catch(2),n((o=t.t0,{type:b.R.UPDATE_OFFICE_FAIL,payload:o})),(0,y.Mn)(t.t0.message);case 19:case"end":return t.stop()}var o}),t,null,[[2,15]])})));return function(e){return t.apply(this,arguments)}}()},O=function(e,t){return function(){var n=(0,c.Z)(o().mark((function n(i){var r,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i(g()),n.next=4,x(e,t);case 4:r=n.sent,a=r.data,i(j(a)),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),i(N(n.t0)),(0,y.Mn)(n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},E=function(){return function(){var e=(0,c.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:b.R.CLEAR_OFFICE}),e.abrupt("return",!0);case 5:e.prev=5,e.t0=e.catch(0),(0,y.Mn)(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},S=n(12721),C=n(537),A=n(16030),F=n(12202),I=n(98158),M=n(28931),T=n(93969),L=n(90883),R=n(81829),D=n(80184),_=function(e){var t=e.currentPage,n=e.postsPerPage,a=e.setCurrentPage,s=e.count,l=e.setShowModal,u=e.maxPageNumberLimit,d=e.setMaxPageNumberLimit,v=e.minPageNumberLimit,m=e.setMinPageNumberLimit,h=e.search,x=(0,A.v9)((function(e){return e.auth.permissions})),P=(0,A.v9)((function(e){return e.auth.isAdmin})),k=(0,A.v9)((function(e){return e.auth.isSuperuser})),Z=(0,A.v9)((function(e){return e.office})),O=Z.previous,E=Z.next,S=(0,A.v9)((function(e){return e.office.offices})),C=(0,A.I0)(),M=(0,r.useState)(5),_=(0,i.Z)(M,1)[0],V=(null===x||void 0===x?void 0:x.includes("can_create_office"))||P||k;return(0,D.jsx)(D.Fragment,{children:(null===S||void 0===S?void 0:S.length)>0?(0,D.jsxs)("div",{className:"mt-2 d-flex flex-column justify-content-between",children:[(0,D.jsx)("div",{className:"table-scrollable",children:(0,D.jsxs)("table",{className:"table table-hover table-bordered text-center",children:[(0,D.jsx)("thead",{children:(0,D.jsxs)("tr",{children:[(0,D.jsx)("th",{scope:"col",style:{width:"2%"},children:"S.N"}),(0,D.jsx)("th",{scope:"col",className:"text-left",children:"Name"}),(0,D.jsx)("th",{scope:"col",children:"Active"}),(0,D.jsx)("th",{scope:"col",children:"Action"})]})}),(0,D.jsx)("tbody",{children:(null===S||void 0===S?void 0:S.length)>0&&S.map((function(e,i){var r=e.id,a=e.name,c=e.isActive;return(0,D.jsxs)("tr",{children:[(0,D.jsxs)("td",{className:"fw-bold",style:{width:"2%"},children:[n*(t-1)+(i+1)," "]}),(0,D.jsx)("td",{className:"text-left",children:a}),(0,D.jsx)("td",{children:(0,D.jsx)(T.Z,{active:c})}),(0,D.jsx)("td",{children:V&&(0,D.jsx)(I.Z,{content:"Edit",children:(0,D.jsx)("button",{onClick:function(){return function(e){C({type:b.R.EDIT_OFFICE,payload:e}),l(!0)}(r)},className:"btn btn-md btn-edit btn-primary",children:(0,D.jsx)(F.fmQ,{size:16})})})})]},r)}))})]})}),s>0&&(0,D.jsx)(L.Z,{currentPage:t,postsPerPage:n,count:s,paginate:function(e){C(w({number:e,postsPerPage:n})),a(e)},handleClick:function(e){"previous"===e?(C(function(e){return function(){var t=(0,c.Z)(o().mark((function t(n){var i,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(g()),t.next=4,f(e);case 4:i=t.sent,r=i.data,n(j(r)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),n(N(t.t0)),(0,y.Mn)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}(O)),a((function(e){return e-1})),(t-1)%_===0&&(d(u-_),m(v-_))):"next"===e&&(C(function(e){return function(){var t=(0,c.Z)(o().mark((function t(n){var i,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(g()),t.next=4,p(e);case 4:i=t.sent,r=i.data,n(j(r)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),n(N(t.t0)),(0,y.Mn)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}(E)),a((function(e){return e+1})),t+1>u&&(d(u+_),m(v+_)))},setCurrentPage:a,minPageNumberLimit:v,maxPageNumberLimit:u})]}):(0,D.jsx)(R.Z,{search:h,onClick:function(){return l(!0)},addPermission:V})})},V=n(1413),U=n(76863),B=n(92506),G=n(94924),J=n(2557),W=n(29815),q=n(31274),z=function(){var e=(0,c.Z)(o().mark((function e(t,n,i){var r,a,c,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.limit,a=i.offset,e.next=3,(0,l.ZP)("api/v1/core-app/province/list?search=".concat(t,"&offset=").concat(a,"&limit=").concat(r));case 3:return c=e.sent,s=c.data,e.abrupt("return",{options:s.data,hasMore:s.count>r,additional:{offset:r,limit:r+10}});case 6:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),Q=function(){var e=(0,c.Z)(o().mark((function e(t,n,i){var r,a,c,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.limit,a=i.offset,c=i.province,e.next=3,(0,l.ZP)("api/v1/core-app/district/list?search=".concat(t,"&offset=").concat(a,"&limit=").concat(r,"&province__id=").concat(null!==c?null===c||void 0===c?void 0:c.id:""));case 3:return s=e.sent,u=s.data,e.abrupt("return",{options:u.data,hasMore:u.count>r,additional:{offset:r,limit:r+10,province:c}});case 6:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),H=function(){var e=(0,c.Z)(o().mark((function e(t,n,i){var r,a,c,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.limit,a=i.offset,c=i.district,e.next=3,(0,l.ZP)("api/v1/core-app/palika-for-office/list?search=".concat(t,"&offset=").concat(a,"&limit=").concat(r,"&district__id=").concat(null!==c?null===c||void 0===c?void 0:c.id:""));case 3:return s=e.sent,u=s.data,e.abrupt("return",{options:u.data,hasMore:u.count>r,additional:{offset:r,limit:r+10,district:c}});case 6:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),X=n(25922),K=function(e){var t=e.setShowModal,n=(e.showModal,e.currentPage),i=(0,A.v9)((function(e){return e.office})),r=i.office,a=i.edit,s={officeType:a?X.ir.find((function(e){return e.id===(null===r||void 0===r?void 0:r.officeType)})):"",province:a&&r?r.province:null,district:a&&r?r.district:null,palika:a&&r?r.palika:null,ward:a&&r?r.ward:null,isActive:!!a&&(null===r||void 0===r?void 0:r.isActive)},l=U.Ry().shape({province:U.Ry().nullable(),district:U.Ry().nullable(),palika:U.Ry().nullable(),ward:U.Rx().integer("Ward must be an integer").typeError("Please enter a valid Ward No").positive("Ward must be a positive number").required("Ward is required"),isActive:U.Xg()}),u=(0,A.I0)(),d=function(){var e=(0,c.Z)(o().mark((function e(i){var c,s,l,d,f,p,v,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=i.officeType,s=i.district,l=i.province,d=i.palika,f=(0,V.Z)((0,V.Z)({},i),{},{officeType:null===c||void 0===c?void 0:c.id,district:null===s||void 0===s?void 0:s.id,province:null===l||void 0===l?void 0:l.id,palika:null===d||void 0===d?void 0:d.id}),a){e.next=9;break}return e.next=5,u(k(f,n,10));case 5:p=e.sent,t(!p),e.next=14;break;case 9:return v={id:null===r||void 0===r?void 0:r.id,values:(0,V.Z)((0,V.Z)({},i),{},{officeType:null===c||void 0===c?void 0:c.id,district:null===s||void 0===s?void 0:s.id,province:null===l||void 0===l?void 0:l.id,palika:null===d||void 0===d?void 0:d.id}),currentPage:n},e.next=12,u(Z(v));case 12:m=e.sent,t(!m);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,D.jsx)("div",{className:"row",children:(0,D.jsx)("div",{className:"col-12",children:(0,D.jsx)(B.J9,{initialValues:s,validationSchema:l,onSubmit:d,children:function(e){var t,n,i,r,c,s,o,l=e.setFieldValue;return(0,D.jsxs)(B.l0,{autoComplete:"off",children:[(0,D.jsx)("div",{className:"my-2",children:(0,D.jsxs)("div",{className:"row",children:[(0,D.jsxs)("div",{className:"col-6 mb-2",children:[(0,D.jsx)("label",{htmlFor:"gender",className:"fw-bold ",children:"Office Type"}),(0,D.jsx)(q.ZP,{value:e.values.officeType,isClearable:"true",isSearchable:"true",name:"officeType",getOptionLabel:function(e){return"".concat(null===e||void 0===e?void 0:e.name," ")},getOptionValue:function(e){return"".concat(null===e||void 0===e?void 0:e.id)},options:X.ir,onChange:function(t){e.setFieldValue("officeType",t)}}),(0,D.jsx)(B.Bc,{name:"officeType",component:G.Z})]}),(0,D.jsxs)("div",{className:"col-6 mb-2",children:[(0,D.jsxs)("label",{htmlFor:"province",className:"fw-bold float-start",children:["Province",(0,D.jsx)("strong",{className:"text-danger ",children:"*"})]}),(0,D.jsx)(W.n9,{blurInputOnSelect:!0,value:e.values.province,isClearable:"true",isSearchable:"true",name:"province",inputId:"input",getOptionLabel:function(e){return"".concat(e.name)},getOptionValue:function(e){return"".concat(null===e||void 0===e?void 0:e.id)},onChange:function(t){var n,i;t?(null===t||void 0===t?void 0:t.id)===(null===(n=e.values)||void 0===n||null===(i=n.province)||void 0===i?void 0:i.id)?l("province",t):(l("province",t),l("district",null),l("palika",null)):(l("province",null),l("district",null),l("palika",null))},loadOptions:z,additional:{offset:0,limit:10}}),(0,D.jsx)(B.Bc,{name:"province",component:G.Z})]}),(0,D.jsxs)("div",{className:"col-6 mb-2",children:[(0,D.jsxs)("label",{htmlFor:"district",className:"fw-bold float-start",children:["District",(0,D.jsx)("strong",{className:"text-danger ",children:"*"})]}),(0,D.jsx)(W.n9,{blurInputOnSelect:!0,value:e.values.district,isClearable:"true",isSearchable:"true",name:"district",inputId:"input",isDisabled:null===(null===(n=e.values)||void 0===n?void 0:n.province),getOptionLabel:function(e){return"".concat(e.name)},getOptionValue:function(e){return"".concat(null===e||void 0===e?void 0:e.id)},onChange:function(t){var n,i;t?(null===t||void 0===t?void 0:t.id)===(null===(n=e.values)||void 0===n||null===(i=n.district)||void 0===i?void 0:i.id)?l("district",t):(l("district",t),l("palika",null)):(l("district",null),l("palika",null))},loadOptions:Q,additional:{offset:0,limit:10,province:null===e||void 0===e||null===(i=e.values)||void 0===i?void 0:i.province}},JSON.stringify(null===(t=e.values)||void 0===t?void 0:t.province)),(0,D.jsx)(B.Bc,{name:"district",component:G.Z})]}),(0,D.jsxs)("div",{className:"col-6 mb-2",children:[(0,D.jsxs)("label",{htmlFor:"palika",className:"fw-bold float-start",children:["Palika",(0,D.jsx)("strong",{className:"text-danger ",children:"*"})]}),(0,D.jsx)(W.n9,{blurInputOnSelect:!0,disabled:null===(null===e||void 0===e||null===(c=e.values)||void 0===c?void 0:c.district),value:e.values.palika,isClearable:"true",isSearchable:"true",name:"palika",inputId:"input",isDisabled:null===(null===e||void 0===e||null===(s=e.values)||void 0===s?void 0:s.district),getOptionLabel:function(e){return"".concat(e.name)},getOptionValue:function(e){return"".concat(null===e||void 0===e?void 0:e.id)},onChange:function(e){l("palika",e)},loadOptions:H,additional:{offset:0,limit:10,district:null===e||void 0===e||null===(o=e.values)||void 0===o?void 0:o.district}},JSON.stringify(null===(r=e.values)||void 0===r?void 0:r.district)),(0,D.jsx)(B.Bc,{name:"palika",component:G.Z})]}),(0,D.jsxs)("div",{className:"col-6 mb-2",children:[(0,D.jsxs)("label",{htmlFor:"ward",className:"fw-bold float-start",children:["Ward",(0,D.jsx)("strong",{className:"text-danger ",children:"*"})]}),(0,D.jsx)(B.gN,{type:"number",value:e.values.ward,name:"ward",onChange:function(e){l("ward",e.target.value)},className:"form-control ",placeholder:"Ward Number"}),(0,D.jsx)(B.Bc,{name:"ward",component:G.Z})]})]})}),(0,D.jsx)("div",{className:"form-group row mb-2",children:(0,D.jsxs)("div",{className:"col-12 text-center",children:[(0,D.jsx)(B.gN,{type:"checkbox",name:"isActive",id:"isActive",className:"filled-in chk-col-blue"}),(0,D.jsx)("label",{htmlFor:"isActive",className:"fw-bold  mx-2",children:"Active"})]})}),(0,D.jsx)("div",{className:"my-4 d-flex justify-content-end align-items-center",children:(0,D.jsx)(J.Z,{type:"submit",className:"btn btn-primary",createButton:!0,title:a?"Update":"Save",content:a?"Update":"Save"})})]})}})})})},Y=n(66495),$=function(){(0,M.k6)();var e=(0,A.v9)((function(e){return e.office})),t=e.count,n=e.loading,c=e.loadingUpdate,s=e.edit,o=(0,A.v9)((function(e){return e.auth.isAdmin})),l=(0,A.v9)((function(e){return e.auth.isSuperuser})),u=((0,A.v9)((function(e){return e.auth.permissions})),(0,A.v9)((function(e){return e.office.offices}))),d=(0,A.v9)((function(e){return e.search.search})),f=(0,A.I0)(),p=(0,r.useState)(1),v=(0,i.Z)(p,2),m=v[0],h=v[1],x=(0,r.useState)(5),b=(0,i.Z)(x,2),g=b[0],j=b[1],N=(0,r.useState)(0),y=(0,i.Z)(N,2),w=y[0],k=y[1],Z=(0,r.useState)(10),T=(0,i.Z)(Z,2),L=T[0],R=T[1],V=(0,r.useState)(!1),U=(0,i.Z)(V,2),B=U[0],G=U[1];(0,r.useEffect)((function(){0===L?f(""===d?P(t):O(d,t)):""===d?(L===a.P||h(1),f(P(L))):(h(1),j(5),k(0),f(O(d,L)))}),[f,L,d]);var J=o||l;return(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)("div",{className:"user-card",children:[(0,D.jsx)("div",{className:"header-content",children:(0,D.jsx)("h4",{className:"mb-sm-0 fw-normal",children:"Office Listing"})}),(0,D.jsxs)("div",{className:"".concat((null===u||void 0===u?void 0:u.length)>0?"office-card-body":"card-body"),children:[(0,D.jsx)("div",{className:"row m-0 p-0",children:(null===u||void 0===u?void 0:u.length)>0&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"col-6",children:(0,D.jsx)(C.Z,{postsPerPage:L,setPostsPerPage:R})}),(0,D.jsx)("div",{className:"col-6 text-right",children:J&&(0,D.jsx)(I.Z,{content:"Add",children:(0,D.jsxs)("button",{className:"btn btn-primary waves-effect waves-light btn-sm float-end",onClick:function(){return G(!0)},children:[(0,D.jsx)(F.wEH,{className:"mb-1"}),"\xa0Add New"]})})})]})}),n&&(0,D.jsx)(S.Z,{}),c&&(0,D.jsx)(S.Z,{}),!n&&(0,D.jsx)(_,{currentPage:m,setCurrentPage:h,postsPerPage:L,setPostsPerPage:R,count:t,maxPageNumberLimit:g,setMaxPageNumberLimit:j,minPageNumberLimit:w,setMinPageNumberLimit:k,search:d,showModal:B,setShowModal:G}),B&&(0,D.jsx)(Y.Z,{header:s?"Edit Office":"Create Office",types:"setup",size:"modal-md",setShowModal:G,showModal:B,edit:s,clearAction:E,children:(0,D.jsx)(K,{setShowModal:G,showModal:B,edit:s,currentPage:m})})]})]})})}}}]);
//# sourceMappingURL=6379.e4b31afd.chunk.js.map