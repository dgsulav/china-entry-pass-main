"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4925],{29801:function(e,r,t){t.d(r,{Mn:function(){return s},My:function(){return a},W2:function(){return o}});var n=t(30577);n.Am.configure();var s=function(e){var r="string"===typeof e?e:"error";n.Am.error(r,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},a=function(e){var r="string"===typeof e?e:"success";n.Am.success(r,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},o=function(e){var r="string"===typeof e?e:"success";n.Am.info(r,{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},16587:function(e,r,t){t(72791);var n=t(32328),s=t(80184);r.Z=function(){return(0,s.jsx)("img",{src:n,alt:"spinner",height:"50px"})}},94924:function(e,r,t){t.d(r,{Z:function(){return s}});t(72791);var n=t(80184),s=function(e){return(0,n.jsx)("div",{className:"error",children:e.children})}},34925:function(e,r,t){t.r(r);var n=t(70885),s=t(72791),a=(t(7623),t(92506)),o=t(28931),c=t(76863),i=t(94924),u=t(16030),p=t(52685),l=t(16587),d=t(65804),f=t(80184);r.default=function(e){var r=(0,o.k6)(),t=(0,u.v9)((function(e){return e.auth.loadingReset})),h=(0,u.I0)(),m=(0,s.useState)("password"),v=(0,n.Z)(m,2),w=v[0],x=v[1],y=(0,s.useState)("password"),g=(0,n.Z)(y,2),N=g[0],S=g[1],b=c.Ry().shape({password:c.Z_().required("Please Enter your password").matches(/^(?=.*[a-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{6,}$/,"Must Contain 6 Characters, One alphabet and One Number "),confirm_password:c.Z_().required("Password is required").oneOf([c.iH("password"),null],"Passwords must match")}),j=function(){x("password"===w?"text":"password")},C=function(){S("password"===N?"text":"password")};return(0,f.jsx)("div",{className:"account-pages my-5",children:(0,f.jsx)("div",{className:"container",children:(0,f.jsx)("div",{className:"row justify-content-center",children:(0,f.jsxs)("div",{className:"col-md-8 col-lg-6 col-xl-5",children:[(0,f.jsxs)("div",{className:"card overflow-hidden",children:[(0,f.jsx)("div",{className:"bg-primary bg-soft",children:(0,f.jsx)("div",{className:"row",children:(0,f.jsx)("div",{className:"col-sm-7",children:(0,f.jsx)("div",{className:"text-white p-4",children:(0,f.jsx)("h5",{className:"text-white",children:"Choose a New Password"})})})})}),(0,f.jsx)("div",{className:"card-body pt-0",children:(0,f.jsx)("div",{className:"p-2",children:(0,f.jsx)(a.J9,{initialValues:{password:"",confirm_password:""},validationSchema:b,onSubmit:function(t){var n=t.password,s=t.confirm_password,a=e.match.params.token;h((0,p.Zb)(n,s,a,r))},children:function(e){return(0,f.jsxs)(a.l0,{autoComplete:"off",className:"form-horizontal ",children:[(0,f.jsxs)("div",{className:"mb-3  password-field",children:[(0,f.jsx)("label",{htmlFor:"password",className:"form-label ",children:"New Password"}),(0,f.jsxs)("div",{style:{position:"relative"},children:[(0,f.jsx)(a.gN,{type:w,className:"form-control ",name:"password",placeholder:"New Password"}),(0,f.jsx)("span",{onClick:j,children:"password"===w?(0,f.jsx)(d.cqT,{}):(0,f.jsx)(d.rnh,{})})]}),(0,f.jsx)(a.Bc,{name:"password",component:i.Z})]}),(0,f.jsxs)("div",{className:"mb-3  password-field",children:[(0,f.jsx)("label",{htmlFor:"confirm_password",className:"form-label ",children:"Confirm New Password"}),(0,f.jsxs)("div",{style:{position:"relative"},children:[(0,f.jsx)(a.gN,{type:N,className:"form-control ",name:"confirm_password",placeholder:" Confirm New Password"}),(0,f.jsx)("span",{onClick:C,children:"password"===N?(0,f.jsx)(d.cqT,{}):(0,f.jsx)(d.rnh,{})})]}),(0,f.jsx)(a.Bc,{name:"confirm_password",component:i.Z})]}),(0,f.jsx)("div",{className:"mt-3 d-grid",children:(0,f.jsxs)("button",{className:"btn btn-primary waves-effect waves-light mt-4 m-3",type:"submit",disabled:t,children:["Reset Password ",t&&(0,f.jsx)(l.Z,{})]})})]})}})})})]}),(0,f.jsx)("div",{className:"mt-3 text-center",children:(0,f.jsx)("div",{children:(0,f.jsx)("p",{children:"\xa92021 Nepal-China Entry/Exit Pass."})})})]})})})})}},52685:function(e,r,t){t.d(r,{Cp:function(){return N},Zb:function(){return g},x4:function(){return x},c0:function(){return y},tb:function(){return S}});var n=t(15861),s=t(64687),a=t.n(s),o=t(89731),c=function(e){return o.ZP.post("auth/login",e)},i=function(e){return o.ZP.post("api/v1/user-app/password-reset/",e)},u=function(e){return o.ZP.post("api/v1/user-app/password-reset/confirm/",e)},p=function(e){return o.ZP.patch("auth/change-password",e)},l=function(e){return o.ZP.patch("auth/update-signature",e)},d=t(48044),f=function(){return{type:d.w.LOADING}},h=function(e){return{type:d.w.LOGIN_SUCCESS,payload:e}},m=function(e){return{type:d.w.RESET_SUCCESS,payload:e}},v=function(e){return{type:d.w.PASSWORD_CHANGE_SUCCESS,payload:e}},w=t(29801),x=function(e,r){return function(){var t=(0,n.Z)(a().mark((function t(n){var s,o,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(f()),s={username:e,password:r},t.next=5,c(s);case 5:o=t.sent,i=o.data,(0,w.My)("Welcome ".concat(i.user.username)),n(h(i)),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0,"error"),(0,w.Mn)(t.t0),n((a=t.t0,{type:d.w.LOGIN_FAIL,payload:a}));case 16:case"end":return t.stop()}var a}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},y=function(e){return function(){var r=(0,n.Z)(a().mark((function r(t){var n,s,o;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t({type:d.w.LOADING_RESET_PASSWORD}),n=JSON.stringify({email:e}),r.next=5,i(n);case 5:s=r.sent,o=s.data,t(m(o)),(0,w.My)("Email send successfully "),r.next=15;break;case 11:r.prev=11,r.t0=r.catch(0),t((a=r.t0,{type:d.w.RESET_FAIL,payload:a})),(0,w.Mn)("There is no active user associated with this e-mail address  || the password can not be changed ");case 15:case"end":return r.stop()}var a}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}()},g=function(e,r,t,s){return function(){var o=(0,n.Z)(a().mark((function n(o){var c,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o({type:d.w.LOADING_RESET}),c=JSON.stringify({token:t,password:e,confirm_password:r}),n.next=5,u(c);case 5:i=n.sent,i.data,o({type:d.w.PASSWORD_CONFIRM_SUCCESS}),(0,w.My)("Password has been reset successfully "),o({type:d.w.RESET_SUCCESS,payload:[]}),s.push("/"),n.next=17;break;case 13:n.prev=13,n.t0=n.catch(0),o((a=n.t0,{type:d.w.PASSWORD_CONFIRM_FAIL,payload:a})),(0,w.Mn)("Failed to reset Password");case 17:case"end":return n.stop()}var a}),n,null,[[0,13]])})));return function(e){return o.apply(this,arguments)}}()},N=function(e,r,t,s){return function(){var o=(0,n.Z)(a().mark((function n(o){var c,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o(f()),c=JSON.stringify({password:r,old_password:e,confirm_password:t}),n.next=5,p(c);case 5:i=n.sent,o(v(i)),(0,w.My)("Password changed successfully "),s.push("/"),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),o((a=n.t0,{type:d.w.PASSWORD_CHANGE_FAIL,payload:a})),(0,w.Mn)(n.t0);case 15:case"end":return n.stop()}var a}),n,null,[[0,11]])})));return function(e){return o.apply(this,arguments)}}()},S=function(e){return function(){var r=(0,n.Z)(a().mark((function r(t){var n,s;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t(f()),n=JSON.stringify({signature:e,signatureUpdating:!0}),r.next=5,l(n);case 5:return s=r.sent,(0,w.My)("Signature updated successfully"),t((o=null===s||void 0===s?void 0:s.data,{type:d.w.UPDATE_SIGNATURE_SUCCESS,payload:o})),r.abrupt("return",!0);case 11:r.prev=11,r.t0=r.catch(0),t((a=r.t0,{type:d.w.UPDATE_SIGNATURE_FAIL,payload:a})),(0,w.Mn)(r.t0);case 15:case"end":return r.stop()}var a,o}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}()}},89731:function(e,r,t){t.d(r,{Yb:function(){return l}});var n=t(15861),s=t(64687),a=t.n(s),o=t(74569),c=t.n(o),i=t(90106),u=t(48044),p=t(30577),l=(c().create({baseURL:"http://chinapass.sushiloli.com.np"}),c().create({baseURL:"http://localhost:9010",headers:{"Content-Type":"application/json"}})),d=c().create({baseURL:"http://chinapass.sushiloli.com.np",headers:{"Content-Type":"application/json"}});d.interceptors.request.use((function(e){if(window.navigator.onLine)return e.headers.Authorization=localStorage.getItem("accessToken")?"Bearer ".concat(localStorage.getItem("accessToken")):null,e.baseURL="http://chinapass.sushiloli.com.np",e}),(function(e){return Promise.reject(e)})),d.interceptors.response.use((function(e){return e}),function(){var e=(0,n.Z)(a().mark((function e(r){var t,n,s,o,c,l,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.config,401===r.response.status&&"auth/token/refresh"===c.url&&i.h.dispatch({type:u.w.AUTH_ERROR}),"token_not_valid"!==(null===(t=r.response)||void 0===t?void 0:t.data.code)||c._retry){e.next=19;break}return c._retry=!0,e.prev=4,l=JSON.stringify({refresh:localStorage.getItem("refreshToken")}),localStorage.removeItem("accessToken"),e.next=9,d.post("auth/token/refresh",l);case 9:if(200!==(f=e.sent).status){e.next=14;break}return localStorage.setItem("accessToken",null===f||void 0===f?void 0:f.data.access),c.headers.Authorization="Bearer ".concat(null===f||void 0===f?void 0:f.data.access),e.abrupt("return",d(c));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),i.h.dispatch({type:u.w.AUTH_ERROR});case 19:if("No Internet"===r&&p.Am.error("No Internet Connection !!!"),"Network Error"===r.message&&p.Am.error("Internal Server Error. Contact IT manager !!!",{autoClose:1200}),500===(null===(n=r.response)||void 0===n?void 0:n.status)&&p.Am.error("Internal Server Error. Contact IT manager !!!",{autoClose:1200}),404===(null===(s=r.response)||void 0===s?void 0:s.status)&&p.Am.error("Page Not Found !!!!!",{autoClose:1200}),401!==(null===(o=r.response)||void 0===o?void 0:o.status)&&"Invalid token specified"!==r.message){e.next=26;break}return i.h.dispatch({type:u.w.AUTH_ERROR}),e.abrupt("return",Promise.reject(r.response.data.detail));case 26:if(!(r.response&&r.response.status>=400&&r.response.status<500)){e.next=33;break}if(!r.response.data.detail){e.next=32;break}return e.abrupt("return",Promise.reject("".concat(r.response.data.detail)));case 32:return e.abrupt("return",Promise.reject("".concat(r.response.statusText)));case 33:return e.abrupt("return",Promise.reject(r));case 34:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(r){return e.apply(this,arguments)}}()),r.ZP=d},7623:function(){},32328:function(e,r,t){e.exports=t.p+"static/media/spinner.9012f56ae4662e1be3c6.gif"}}]);
//# sourceMappingURL=4925.62e57ccb.chunk.js.map